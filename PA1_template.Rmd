---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

```{r echo=TRUE}
activity <- read.csv("~/GitHub/RepData_PeerAssessment1/activity/activity.csv")
activityw <- reshape(activity, direction="wide", timevar="interval", idvar="date", v.names="steps")
colnames(activityw)[-1] <- substring(colnames(activityw)[-1],7)
```

## What is mean total number of steps taken per day?

```{r echo=TRUE}
daysumsw <- rowSums(activityw[,-1], na.rm=TRUE)
hist(daysumsw,breaks=seq(0,25000,by=1000))
mean(daysumsw, na.rm=TRUE)
median(daysumsw, na.rm=TRUE)
```

## What is the average daily activity pattern?

```{r echo=TRUE}
timemeansw <- colMeans(activityw[,-1], na.rm=TRUE)
dectimes <- as.numeric(names(timemeansw)) %/% 100 + as.numeric(names(timemeansw)) %% 100 / 60
plot(dectimes,timemeansw,type="l")
```

## Imputing missing values

```{r echo=TRUE}
expected <- activity
for (i in seq(1,length(expected$steps))) {
  if (is.na(expected$steps[i])) {
    expected$steps[i] <- timemeans$`activity$steps`[]
  }        
}
```

## Are there differences in activity patterns between weekdays and weekends?
